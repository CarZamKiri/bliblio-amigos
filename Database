-- Crear la tabla Estado_Usuarios
CREATE TABLE Estado_Usuarios (
  id_estatus SERIAL PRIMARY KEY,
  nombre_estado VARCHAR(50) -- Activo, baja, suspendido
);

-- Crear la tabla Tipo_usuario
CREATE TABLE Tipo_usuario (
  ID_tipo SERIAL PRIMARY KEY,
  nombre_tipo VARCHAR(50) -- Admin, cliente
);

-- Crear la tabla Usuarios
CREATE TABLE Usuarios (
  ID SERIAL PRIMARY KEY,
  Nombre VARCHAR(100),
  NombreUsuario VARCHAR(50) UNIQUE,
  Contrasena VARCHAR(100), -- La contraseña debe estar encriptada
  Email VARCHAR(100),
  Estado INT,
  Tipo INT,
  FOREIGN KEY (Estado) REFERENCES Estado_Usuarios(id_estatus),
  FOREIGN KEY (Tipo) REFERENCES Tipo_usuario(ID_tipo)
);

-- Crear la tabla detalles_usuarios
CREATE TABLE detalles_usuarios (
  FechaNacimiento DATE,
  Genero VARCHAR(20),
  Direccion VARCHAR(255),
  Telefono VARCHAR(20),
  ImagenPerfil VARCHAR(255),
  Biografia TEXT,
  Intereses TEXT,
  NumeroVisitas INT,
  ID_usuario INT,
  FOREIGN KEY (ID_usuario) REFERENCES Usuarios(ID)
);

-- Crear la tabla genero
CREATE TABLE genero (
  id_genero SERIAL PRIMARY KEY,
  nombre VARCHAR(50) -- romance, comedia
);

-- Crear la tabla Categoria
CREATE TABLE Categoria (
  id_categoria SERIAL PRIMARY KEY,
  nombre VARCHAR(50)
);

-- Crear la tabla Editoriales
CREATE TABLE Editoriales (
  ID_editorial SERIAL PRIMARY KEY,
  nombre VARCHAR(100),
  direccion VARCHAR(255),
  telefono VARCHAR(20)
);

-- Crear la tabla Autores
CREATE TABLE Autores (
  ID_autor SERIAL PRIMARY KEY,
  nombre VARCHAR(100),
  biografía TEXT
);

-- Crear la tabla Libros
CREATE TABLE Libros (
  ID SERIAL PRIMARY KEY,
  Titulo VARCHAR(255),
  Autor INT,
  Genero INT,
  AnioPublicacion INT,
  Editorial INT,
  ISBN VARCHAR(20),
  Recomendacion BOOLEAN,
  Categoria INT,
  FOREIGN KEY (Autor) REFERENCES Autores(ID_autor),
  FOREIGN KEY (Genero) REFERENCES genero(id_genero),
  FOREIGN KEY (Editorial) REFERENCES Editoriales(ID_editorial),
  FOREIGN KEY (Categoria) REFERENCES Categoria(id_categoria)
);

-- Crear la tabla Biblioteca_P
CREATE TABLE Biblioteca_P (
  ID SERIAL PRIMARY KEY,
  UsuarioID INT,
  LibroID INT,
  Notas TEXT,
  Estado VARCHAR(20), -- Leido, proceso
  fecha_in DATE,
  FOREIGN KEY (UsuarioID) REFERENCES Usuarios(ID),
  FOREIGN KEY (LibroID) REFERENCES Libros(ID)
);

-- Crear la tabla Libros_Editoriales
CREATE TABLE Libros_Editoriales (
  ID_libro INT,
  ID_editorial INT,
  fecha_publicacion DATE,
  FOREIGN KEY (ID_libro) REFERENCES Libros(ID),
  FOREIGN KEY (ID_editorial) REFERENCES Editoriales(ID_editorial)
);

-- Crear la tabla Resenas
CREATE TABLE Resenas (
  ID_resena SERIAL PRIMARY KEY,
  ID_usuario INT,
  ID_libro INT,
  resena TEXT,
  calificacion INT,
  fecha DATE,
  FOREIGN KEY (ID_usuario) REFERENCES Usuarios(ID),
  FOREIGN KEY (ID_libro) REFERENCES Libros(ID)
);
